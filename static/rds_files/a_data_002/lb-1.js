XD={channelUrl:null,init:function(a){this.channelUrl=a.channelUrl||null},send:function(f,e){this.channelUrl=e||this.channelUrl;if(typeof f!="string"){f=zm.param(f)}var b=this.channelUrl+"&"+f;var a="z"+(Math.random()*(1<<30)).toString(16).replace(".","");var d={src:b,frameborder:0,scrolling:"no",name:a,id:a};var c={height:"0px"};this._insertIframe(d,c)},_insertIframe:function(c,b,d){var a=zm.createElement("iframe",c,b);a.onload=function(){window.setTimeout(function(){a.parentNode.removeChild(a)},200)};d=d||zm("body")[0];d.appendChild(a)}};windowComm={_callbacks:{},makeHandler:function(e,c){c=c||"opener";var b="z"+(Math.random()*(1<<30)).toString(16).replace(".","");windowComm._callbacks[b]=e;var d={_id:b,_relation:c};var a="http://sp.me.zing.vn/plugins/window_comm.php#"+zm.param(d);return a},_recv:function(a){query=a.substr(a.indexOf("?")+1);query=query.replace("#","&");var g={},e=query.split("&"),c,f;for(c=0;c<e.length;c++){f=e[c].split("=");var b=f[0];f=f.slice(1,f.length);var d=f.join("=");g[decodeURIComponent(b)]=decodeURIComponent(d)}windowComm._callbacks[g._id](g)}};windowPopup={open:function(a,b,i){var e=typeof window.screenX!="undefined"?window.screenX:window.screenLeft,c=typeof window.screenY!="undefined"?window.screenY:window.screenTop,j=typeof window.outerWidth!="undefined"?window.outerWidth:document.body.clientWidth,h=typeof window.outerHeight!="undefined"?window.outerHeight:(document.body.clientHeight-22),d=parseInt(e+((j-b)/2),10),g=parseInt(c+((h-i)/2.5),10),f=("width="+b+",height="+i+",left="+d+",top="+g);return window.open(a,"_blank",f)}};connectLogin={init:function(a){this.appID=a.appID;this.loginUrl=a.loginUrl;this.channelUrl=a.channelUrl},login:function(){this._openPopup();return false},_openPopup:function(e){var b=windowComm.makeHandler(function(f){connectLogin._closePopup();if(connectLogin.appID){connectLogin._refreshLoginStatus()}e&&e()}),c=windowComm.makeHandler(function(f){connectLogin._closePopup()});var d={app_id:this.appID,cancel:c,next:b,type:"popup"};var a=this.loginUrl+"?*=&"+zm.param(d);this._popup=windowPopup.open(a,600,300)},_closePopup:function(){if(this._popup){if(zm.browser.msie){var a=this._popup;setTimeout(function(){a.close();a=null},200)}else{this._popup.close();this._popup=null}}},_refreshLoginStatus:function(){if(this.channelUrl){XD.send({type:"refreshLoginStatus"},this.channelUrl)}else{window.location.reload()}}};